
# Сервис контроллера доп. устройств

Сервис представлен отдельным Веб-сервером предоставляющий API для управления Adruino контроллером.

Сервис корректно доступен только в окружении реального киоска - при условии, что оборудование физически присутствует.   

### Оборудование:
- датчик движения - фиксирует движение и отправляет события посредством WS соединения
- каналы управления подсветкой (3 штуки), позволяют включать/выключать подсветки: 1, 2, 3
  (какой канал за что отвечает уточнять у разработчика киоска)

### Подключение:

Сервис принимает __API__ запросы: ___http://localhost:9671___

Сервис принимает __WebSocket__ соединения: ___ws://localhost:9671___



### REST API:
| Метод | URI | Действие | Возвращаемое значение |
|-----|-----|-----|-----|
| `POST` | `/light/1` | Включить первый(1) канал подсветки |  - -  |
| `POST` | `/light/2` | Включить второй(2) канал подсветки |  - -  |
| `POST` | `/light/3` | Включить третий(3) канал подсветки |  - -  |
| `DELETE` | `/light/1` | Выключить первый(1) канал подсветки |  - -  |
| `DELETE` | `/light/2` | Выключить второй(1) канал подсветки |  - -  |
| `DELETE` | `/light/3` | Выключить третий(1) канал подсветки |  - -  |

### WebSocket

#### Получаемые сообщения (события):

| Сообщений | Описание |
|-----|-----|
| `{"event":"motionStart"}` |  Зафиксировано движение |
| `{"event":"motionEnd"}` |  Движение прекращено |
| `{"event":"deviceConnect"}` |  Контроллер подключен |
| `{"event":"deviceDisconnect"}` |  Связь с контроллером прервана |

#### Отправляемые сообщения (команды):

| Сообщений | Описание |
|-----|-----|
| `{"command":"POST:/light/1"}` | Включить первый(1) канал подсветки |
| `{"command":"POST:/light/2"}` | Включить второй(2) канал подсветки |
| `{"command":"POST:/light/3"}` | Включить третий(3) канал подсветки |
| `{"command":"DELETE:/light/1"}` | Выключить первый(1) канал подсветки |
| `{"command":"DELETE:/light/2"}` | Выключить второй(2) канал подсветки |
| `{"command":"DELETE:/light/3"}` | Выключить третий(3) канал подсветки |

### Тестирование:
 По адресу:  http://localhost/testing/controller.html находится простой интерфейс для проверки работы сервиса и демонстрации работы с ним. 

